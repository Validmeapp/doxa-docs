---
title: "API Reference - Requests"
description: "Referencia completa de endpoints para crear y gestionar solicitudes"
version: "v1"
locale: "es"
order: 2
category: "developer-guide"
subcategory: "api-reference"
lastUpdated: "2025-10-26"
icon: "api"
---

# Requests API Reference

Referencia t√©cnica completa para trabajar con solicitudes de validaci√≥n.

---

## üìç Base URL

```
Desarrollo: https://dev.api.validme.tech
Producci√≥n: https://api.validme.tech
```

## üîê Autenticaci√≥n

Todos los requests requieren el header:

```
x-vm-authorization: Bearer YOUR_API_TOKEN
Content-Type: application/json
```

---

## 1. POST /requests

### Crear Nueva Solicitud

Inicia una nueva validaci√≥n.

**Endpoint:**
```
POST https://api.validme.tech/requests
```

**Headers:**
```
x-vm-authorization: Bearer sk_live_...
Content-Type: application/json
```

### Request Body

#### Par√°metros Requeridos

| Par√°metro | Tipo | Descripci√≥n |
|-----------|------|-------------|
| `phoneNumber` | string | Tel√©fono del usuario con c√≥digo de pa√≠s (ej: `+59165890904`) |
| `description` | string | Descripci√≥n clara del motivo de validaci√≥n |
| `category` | string | `DOCUMENT_VALIDATION`, `CONSENT`, `SESSION` |
| `callbackUrls` | array | URLs donde recibir√°s webhooks |

#### Par√°metros Condicionales

**Opci√≥n A: Especificar tipos de verificaci√≥n**
```
"verificationTypes": ["NATIONAL_ID", "SELFIE"]
```

**Opci√≥n B: Usar Flow Predefinido**
```
"flowId": "flow_68d85ee81c623d111e303c5e"
```

#### Par√°metros Opcionales

| Par√°metro | Tipo | Descripci√≥n |
|-----------|------|-------------|
| `metadata` | object | Datos personalizados para tu referencia |
| `acceptanceMode` | string | `BUTTON` (default), `OTP`, `CHOICE` |
| `mode` | string | `PAYLOAD`, `FILES`, `ALL` (default) |

### Request Body - Ejemplo

```json
{
  "verificationTypes": ["NATIONAL_ID", "SELFIE"],
  "phoneNumber": "+59165890904",
  "description": "Validaci√≥n KYC - Apertura de cuenta",
  "category": "DOCUMENT_VALIDATION",
  "acceptanceMode": "BUTTON",
  "callbackUrls": [
    "https://tuapi.com/webhooks/validme"
  ],
  "metadata": {
    "customerId": "user_123",
    "referenceCode": "KYC-2025-001",
    "department": "Compliance"
  }
}
```

### Response - 201 Created

```json
{
  "success": true,
  "data": {
    "_id": "68f41f9221765dd7a4102dd6",
    "accountId": "68e56f7e8a624a901884b831",
    "organizationId": "68d85ee81c623d111e303c5e",
    "code": "ABC123",
    "status": "PENDING",
    "verifications": [
      {
        "status": "PENDING",
        "type": "NATIONAL_ID"
      },
      {
        "status": "PENDING",
        "type": "SELFIE"
      }
    ],
    "mode": "ALL",
    "acceptanceMode": "BUTTON",
    "category": "DOCUMENT_VALIDATION",
    "callbackUrls": [
      "https://tuapi.com/webhooks/validme"
    ],
    "metadata": {
      "customerId": "user_123",
      "referenceCode": "KYC-2025-001"
    },
    "statusTransitions": [
      {
        "status": "PENDING",
        "description": "Request created",
        "timestamp": "2025-10-26T15:30:00.000Z"
      }
    ],
    "createdAt": "2025-10-26T15:30:00.000Z",
    "updatedAt": "2025-10-26T15:30:00.000Z"
  }
}
```

### Response Fields

| Campo | Tipo | Descripci√≥n |
|-------|------|-------------|
| `_id` | string | ID √∫nico del request |
| `code` | string | C√≥digo de 6 d√≠gitos para usuario |
| `status` | enum | Estado actual (PENDING, CONFIRMED, etc) |
| `verifications` | array | Array de verificaciones |
| `statusTransitions` | array | Hist√≥rico de cambios de estado |

---

## 2. GET /requests/:id

### Obtener Solicitud Individual

Recupera el estado y detalles de una solicitud.

**Endpoint:**
```
GET https://api.validme.tech/requests/68f41f9221765dd7a4102dd6
```

**Headers:**
```
x-vm-authorization: Bearer sk_live_...
```

### Response - 200 OK

```json
{
  "success": true,
  "data": {
    "_id": "68f41f9221765dd7a4102dd6",
    "status": "SUCCESS",
    "code": "ABC123",
    "verifications": [
      {
        "status": "SUCCESS",
        "type": "NATIONAL_ID",
        "confidence": 0.98
      },
      {
        "status": "SUCCESS",
        "type": "SELFIE",
        "confidence": 0.96
      }
    ],
    "statusTransitions": [
      {
        "status": "PENDING",
        "description": "Request created",
        "timestamp": "2025-10-26T15:30:00.000Z"
      },
      {
        "status": "CONFIRMED",
        "timestamp": "2025-10-26T15:35:00.000Z"
      },
      {
        "status": "SENDING",
        "timestamp": "2025-10-26T15:36:00.000Z"
      },
      {
        "status": "SUCCESS",
        "timestamp": "2025-10-26T15:45:00.000Z"
      }
    ],
    "metadata": {
      "customerId": "user_123"
    },
    "createdAt": "2025-10-26T15:30:00.000Z",
    "updatedAt": "2025-10-26T15:45:00.000Z"
  }
}
```

---

## 3. GET /requests

### Listar Solicitudes

Recupera un listado de solicitudes con paginaci√≥n.

**Endpoint:**
```
GET https://api.validme.tech/requests
```

**Query Parameters:**

| Par√°metro | Tipo | Descripci√≥n |
|-----------|------|-------------|
| `page` | integer | N√∫mero de p√°gina (default: 1) |
| `limit` | integer | Resultados por p√°gina (default: 20, max: 100) |
| `status` | string | Filtrar por estado (PENDING, SUCCESS, FAILED, etc) |
| `from` | date | Filtrar desde fecha (ISO 8601) |
| `to` | date | Filtrar hasta fecha (ISO 8601) |
| `sortBy` | string | Campo para ordenar (createdAt, status) |
| `order` | string | `asc` o `desc` |

### Ejemplo de Query

```
GET https://api.validme.tech/requests?page=1&limit=20&status=SUCCESS&from=2025-10-01&to=2025-10-31&sortBy=createdAt&order=desc
```

### Response - 200 OK

```json
{
  "success": true,
  "data": {
    "requests": [
      {
        "_id": "68f41f9221765dd7a4102dd6",
        "status": "SUCCESS",
        "code": "ABC123",
        "phoneNumber": "+59165890904",
        "metadata": { "customerId": "user_123" },
        "createdAt": "2025-10-26T15:30:00.000Z",
        "updatedAt": "2025-10-26T15:45:00.000Z"
      },
      {
        "_id": "68f41f9221765dd7a4102dd7",
        "status": "PENDING",
        "code": "DEF456",
        "phoneNumber": "+59162345678",
        "metadata": { "customerId": "user_124" },
        "createdAt": "2025-10-26T14:00:00.000Z",
        "updatedAt": "2025-10-26T14:00:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 245,
      "pages": 13
    }
  }
}
```

---

## 4. DELETE /requests/:id

### Cancelar Solicitud

Cancela una solicitud pendiente (antes de que usuario confirme).

**Endpoint:**
```
DELETE https://api.validme.tech/requests/68f41f9221765dd7a4102dd6
```

**Headers:**
```
x-vm-authorization: Bearer sk_live_...
```

### Response - 200 OK

```json
{
  "success": true,
  "data": {
    "_id": "68f41f9221765dd7a4102dd6",
    "status": "CANCELLED",
    "message": "Request cancelled successfully",
    "deletedAt": "2025-10-26T16:00:00.000Z"
  }
}
```

### Estados Cancelables

```
‚úì PENDING - Puedes cancelar
‚úì CONFIRMED - Puedes cancelar
‚úó SENDING - No puedes cancelar
‚úó SUCCESS - No puedes cancelar (finalizado)
‚úó FAILED - Ya est√° cancelado
‚úó REJECTED - Ya est√° cancelado
‚úó EXPIRED - Ya est√° cancelado
```

---

## Estados del Request

### Diagrama de Estados

```
PENDING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí CONFIRMED ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí SENDING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí SUCCESS
  ‚Üì                                                          ‚úì
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  
REJECTED (usuario rechaza)
EXPIRED (tiempo excedido, 24h)
FAILED (validaci√≥n no aprobada)
INVALIDATED (usuario ingresa OTP incorrecto)
```

### Significado de Estados

| Estado | Significado |
|--------|-------------|
| **PENDING** | Request creado, esperando usuario |
| **CONFIRMED** | Usuario confirm√≥ recibir SMS/link |
| **SENDING** | Usuario est√° cargando documentos |
| **SUCCESS** | Validaci√≥n completada exitosamente ‚úÖ |
| **REJECTED** | Usuario rechaz√≥ la solicitud ‚ùå |
| **EXPIRED** | Solicitud expir√≥ (24 horas sin uso) |
| **FAILED** | Validaci√≥n fallida (documentos rechazados) |
| **INVALIDATED** | Usuario ingres√≥ OTP incorrecto |

---

## Verification Types

### Tipos Disponibles

| Tipo | Descripci√≥n | Regi√≥n |
|------|-------------|--------|
| `NATIONAL_ID` | C√©dula de identidad | Bolivia, Per√∫, Colombia |
| `PASSPORT` | Pasaporte | Global |
| `DRIVER_LICENSE` | Licencia de conducci√≥n | Varios |
| `SELFIE` | Selfie de validaci√≥n | Global |
| `SELFIE_VIDEO` | Video con instrucciones | Global |

---

## Par√°metros de Respuesta

### Metadata

Par√°metros personalizados que guardas con cada request:

```javascript
"metadata": {
  "customerId": "12345",
  "referenceCode": "KYC-2025-001",
  "department": "Compliance",
  // ... cualquier dato que necesites
}
```

Se devuelven sin cambios en respuestas y webhooks.

### Acceptance Modes

| Modo | Descripci√≥n |
|------|-------------|
| `BUTTON` | Usuario ve bot√≥n "Aceptar" |
| `OTP` | Usuario ingresa OTP de 6 d√≠gitos |
| `CHOICE` | Usuario elige aceptar/rechazar |

---

## Ejemplos de C√≥digo

### JavaScript/Node.js

```javascript
const axios = require('axios');

async function createRequest() {
  try {
    const response = await axios.post(
      'https://api.validme.tech/requests',
      {
        verificationTypes: ['NATIONAL_ID', 'SELFIE'],
        phoneNumber: '+59165890904',
        description: 'Validaci√≥n KYC',
        category: 'DOCUMENT_VALIDATION',
        acceptanceMode: 'BUTTON',
        callbackUrls: ['https://tuapi.com/webhooks/validme'],
        metadata: {
          customerId: 'user_123',
          reference: 'KYC-2025-001'
        }
      },
      {
        headers: {
          'x-vm-authorization': `Bearer ${process.env.VALIDME_API_TOKEN}`,
          'Content-Type': 'application/json'
        }
      }
    );
    
    console.log('Request created:', response.data.data._id);
    console.log('User code:', response.data.data.code);
    
    return response.data.data;
  } catch (error) {
    console.error('Error:', error.response.data);
  }
}
```

### Python

```python
import requests
import os

def create_request():
    api_url = 'https://api.validme.tech/requests'
    api_token = os.getenv('VALIDME_API_TOKEN')
    
    headers = {
        'x-vm-authorization': f'Bearer {api_token}',
        'Content-Type': 'application/json'
    }
    
    payload = {
        'verificationTypes': ['NATIONAL_ID', 'SELFIE'],
        'phoneNumber': '+59165890904',
        'description': 'Validaci√≥n KYC',
        'category': 'DOCUMENT_VALIDATION',
        'acceptanceMode': 'BUTTON',
        'callbackUrls': ['https://tuapi.com/webhooks/validme'],
        'metadata': {
            'customerId': 'user_123',
            'reference': 'KYC-2025-001'
        }
    }
    
    response = requests.post(api_url, json=payload, headers=headers)
    
    if response.status_code == 201:
        data = response.json()['data']
        print(f"Request created: {data['_id']}")
        print(f"User code: {data['code']}")
        return data
    else:
        print(f"Error: {response.json()}")
```

### cURL

```bash
curl -X POST https://api.validme.tech/requests \
  -H "x-vm-authorization: Bearer sk_live_..." \
  -H "Content-Type: application/json" \
  -d '{
    "verificationTypes": ["NATIONAL_ID", "SELFIE"],
    "phoneNumber": "+59165890904",
    "description": "Validaci√≥n KYC",
    "category": "DOCUMENT_VALIDATION",
    "acceptanceMode": "BUTTON",
    "callbackUrls": ["https://tuapi.com/webhooks/validme"],
    "metadata": {
      "customerId": "user_123",
      "reference": "KYC-2025-001"
    }
  }'
```

---

## C√≥digos de Error

### 400 Bad Request

```json
{
  "success": false,
  "error": {
    "code": "INVALID_PHONE_NUMBER",
    "message": "Phone number format is invalid",
    "detail": "Expected format: +[country][number]"
  }
}
```

### 401 Unauthorized

```json
{
  "success": false,
  "error": {
    "code": "INVALID_TOKEN",
    "message": "API token is invalid or expired"
  }
}
```

### 404 Not Found

```json
{
  "success": false,
  "error": {
    "code": "REQUEST_NOT_FOUND",
    "message": "Request with ID 68f41f9221765dd7a4102dd6 not found"
  }
}
```

---

## Rate Limiting

### L√≠mites

```
Plan Starter: 100 requests/min
Plan Professional: 500 requests/min
Plan Enterprise: Sin l√≠mite (personalizado)
```

### Headers de Rate Limit

```
X-RateLimit-Limit: 500
X-RateLimit-Remaining: 487
X-RateLimit-Reset: 2025-10-26T16:05:00Z
```

### Excediendo L√≠mite

```
HTTP/1.1 429 Too Many Requests

{
  "success": false,
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "Too many requests, retry after 60 seconds"
  }
}
```

---

## Mejores Pr√°cticas

### ‚úÖ DO

- ‚úì Validar n√∫meros de tel√©fono antes de enviar
- ‚úì Guardar `_id` del request en tu BD
- ‚úì Usar `metadata` para referencias internas
- ‚úì Implementar retry logic con backoff exponencial

### ‚ùå DON'T

- ‚úó No exponer API Token en frontend
- ‚úó No hacer requests en bucles sin delay
- ‚úó No ignorar webhooks de erro
- ‚úó No guardar datos sensibles en metadata

---

## Pr√≥ximos Pasos

- [Webhooks Reference](/es/docs/v1/developer-guide/webhooks)
- [Error Codes](/es/docs/v1/developer-guide/api-reference/errors)
- [Security Guide](/es/docs/v1/developer-guide/security/encryption)

---

**√öltima actualizaci√≥n**: 26 de octubre, 2025